# FAQ

- Что это?
    - Это демонстрационный проект, созданный по тестовому заданию вакансии "Python разработчик"
- А почему тут (в коде) сделано так, а рядом по-другому? Почему не в одном стиле?
    - Для демонстрации способности использовать разные инструменты и способы.
- Что такое "тикер"?
  - “Тикер” означает короткий уникальный код (символьное обозначение) криптовалюты или торговой пары. 
    BTC — тикер биткоина, ETH — тикер эфириума.

---

# Тестовое задание

1. Написать клиент для криптобиржи Deribit (https://docs.deribit.com/). Клиент должен каждую минуту забирать с биржи 
    текущую цену btc_usd и eth_usd (index price валюты) после чего сохранять в базу данных тикер валюты, текущую цену и 
    время в UNIX timestamp.
2. Написать внешнее API для обработки сохраненных данных на FastAPI.

## Обязательные требования

1. API должно включать в себя следующие методы:
   - Получение всех сохраненных данных по указанной валюте
   - Получение последней цены валюты
   - Получение цены валюты с фильтром по дате
     Все методы должны быть GET и у каждого метода должен быть обязательный query-параметр “ticker”.
2. В качестве БД использовать PostgreSQL.
3. Код выложить на gitlab с подробным readme и документацией по разворачиванию. В readme добавить секцию Design decisions.
4. Для периодического получения цен использовать Celery.

## Необязательные требования

1. Написать unit тесты для основных методов
2. Развернуть приложение в двух контейнерах для приложения и базы данных.
3. Применить aiohttp при написании клиента. 

## Критерии оценки

1. Чистая архитектура/чистый код
2. Нейминг
3. Отсутсвие глобальных переменных
4. Умение использовать ООП
5. Понимание принятых решений и способность их объяснить


---

# Стэк

- `FastAPI` – API приложения
- `Celery` для выполнения фоновых задач 
- `Celery beat` для запуска периодических задач
- `Redis` как бэкенд для `Celery`
- `PostgreSQL`
- `SQLAlchemy` для запросов к БД
- `Alembic` для миграций
- `AioHTTP` для запросов к API Deribit

---

# Design decisions

- Поскольку приложение асинхронное, то для работы с PostgreSQL 
      выбрана библиотека `asyncpg`, а не `psycopg2` и не async-обертка над ней `aiopg`.

- Для миграций – распространённый `alembic`.

- Для запуска периодической задачи (раз уж необходим Celery) 
  используется Celery beat.

- `uv` как самый быстрый, удобный и современный.

# Настройка

Для локального запуска в Docker нужен файл с переменными `docker/.env`. 
Всё, что внутри, попадёт в контейнеры.

Для локальной работы нужен файл `.env`. Например для создания миграций:
```shell
alembic revision --autogenerate --message="autogenerated migration"
```
Alembic попытается получить переменную окружения `DATABASE_URL` для подключения к БД.
